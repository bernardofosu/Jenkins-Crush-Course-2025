# ğŸ§°âœ¨ Jenkins Installation and Configuration Guide

## â˜ï¸ AWS Setup Guide with Security Group & EC2

### ğŸ” Create a Security Group & Open Ports

1. **Login to AWS Console** â†’ Navigate to **EC2 Dashboard**.
2. **Security Groups** â†’ Click **Create Security Group**.
3. **Fill in details:**

   * ğŸ“› **Name** â†’ e.g., `my-security-group`
   * ğŸ“ **Description** â†’ "Allow web, SSH, and mail traffic"
   * ğŸŒ **VPC** â†’ Select your desired VPC.
4. **Add Inbound Rules:**

   * ğŸ”’ **465 â†’ SMTPS**
   * âš™ï¸ **3000 â€“ 11000 â†’ Custom TCP**
   * ğŸ“¨ **587 â†’ Custom TCP**
   * ğŸŒ **80 â†’ HTTP**
   * ğŸ›¡ï¸ **443 â†’ HTTPS**
   * ğŸ”‘ **22 â†’ SSH**
5. **Save** the security group âœ…

---

### ğŸ–¥ï¸ Launch an EC2 Instance with Existing SG

1. From **EC2 Dashboard**, click **Launch Instance**.
2. **Choose AMI** â†’ e.g., Amazon Linux 2, Ubuntu, etc.
3. **Choose Instance Type** â†’ e.g., `t2.micro` (Free Tier eligible).
4. **Configure Instance:**

   * âš™ï¸ Default settings unless you need custom networking.
5. **Add Storage** â†’ Default or increase as needed.
6. **Configure Security Group:**

   * Select **Use existing security group**
   * âœ… Choose the one you created earlier (`my-security-group`).
7. **Key Pair** â†’ Select or create a new key pair ğŸ”‘.
8. **Review and Launch** ğŸš€.

---

âœ¨ Now your EC2 instance is running with the security group that has the necessary ports open!


## âœ… Prerequisites

Before installing Jenkins, ensure that **â˜• Java** is installed on your system. Jenkins requires Java to run.

**ğŸ“¦ Install OpenJDK 17:**

```bash
sudo apt install openjdk-21-jre-headless -y # Java 21 runtime only (headless)

sudo apt install openjdk-21-jdk -y # Full JDK (compiler + JRE)
```

ğŸ’¡ This installs the necessary Java Runtime Environment to ensure Jenkins functions correctly.

---

## ğŸ“¥ Installing Jenkins

### ğŸ§¾ Step 1ï¸âƒ£: Create a Script for Installation

Create a shell script to automate the installation process. This script will **â¬‡ï¸ download the Jenkins key**, **ğŸ§° add the Jenkins repository**, and **ğŸ“¦ install Jenkins**.

1. **Create a script file named `install-jenkins.sh`:**

[Just copy and paste the link](https://www.jenkins.io/doc/book/installing/linux/#debianubuntu)

   ```bash
   vi install-jenkins.sh
   ```
2. **Copy the following content into the script:**

   ```bash
   #!/bin/bash
   sudo wget -O /usr/share/keyrings/jenkins-keyring.asc \
   https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key
   echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] \
   https://pkg.jenkins.io/debian-stable binary/ | sudo tee \
   /etc/apt/sources.list.d/jenkins.list > /dev/null
   sudo apt-get update
   sudo apt-get install jenkins
   ```

### ğŸ” Step 2ï¸âƒ£: Set Permissions and Run the Script

1. **Make the script executable:**

   ```bash
   sudo chmod +x install-jenkins.sh
   ```
2. **Execute the script to install Jenkins:**

   ```bash
   ./install-jenkins.sh
   ```

ğŸš€ This automates the installation, making it easier to deploy Jenkins on your server.

### Start Jenkins
You can enable the Jenkins service to start at boot with the command:
```sh
sudo systemctl enable jenkins
```
You can start the Jenkins service with the command:
```sh
sudo systemctl start jenkins
```
You can check the status of the Jenkins service using the command:
```sh
sudo systemctl status jenkins
```

## ğŸŒ Accessing Jenkins

Once Jenkins is installed, it can be accessed through a web browser.

1. **ğŸŒ Open Jenkins:** Use your server's public IP address and port **8080**
```sh
   http://your_public_ip:8080`
   http://52.91.22.117:8080/manage/
```
2. **ğŸ”‘ Retrieve the initial admin password:**

```bash
sudo cat /var/lib/jenkins/secrets/initialAdminPassword
```

This password lets you log in and complete the Jenkins setup ![image](set-user-info.png)

password: nakod1234

## ğŸ”Œ Installing Plugins & âš™ï¸ Configuring JDK

### ğŸ§© Step 1ï¸âƒ£: Installing Plugins

1. Navigate to **Manage Jenkins â†’ Manage Plugins**.
2. Under the **Available** tab, search for **"Eclipse Temurin Installer"**.
3. **â¬‡ï¸ Install** the plugin.
![alt text](./manage-ui.png)

![install-plugin](./install-plugin.png)
Restart jenkins and login

### â˜• Step 2ï¸âƒ£: Configuring JDK

1. Go to **Manage Jenkins â†’ Global Tool Configuration â†’ JDK installations**.
2. Add a JDK installation:

   * ğŸ·ï¸ Provide a name for the JDK.
   * âœ… Select **"Install automatically"**.
   * ğŸŒ Choose **"Install from adoptium.net"** and configure **JDK 21**.

This ensures your Jenkins instance can use **JDK 21** for various tasks.

After installing any tool, that tool will show at the tools section 

>[!NOTE] 
At the tools section, you can configure different version of the plugin
![alt text](./confgure-plugin.png)

## Setup Nodes (agents)
![alt text](./node1.png)

[ğŸ¤– Jenkins Master (Controller) and Agents (Slaves)](./Jenkins%20Masterâ€“Agent%20with%20Docker%20â€”%20Bestâ€‘Practice%20Notes.md)

### How to create new node
[How to create new node and setup](./Agent%20Setup%20on%20AWS%20EC2.md)

## ğŸ§± Jenkins Job Types

Different job types help automate stages of the software development lifecycle:

1. **ğŸ§± Freestyle Project**

   * Define a series of build steps (run shell commands, scripts, etc.).
   * Great for simple tasks and projects that don't require complex workflows.
2. **ğŸ› ï¸ Pipeline Project**

   * Use the Pipeline plugin to define build/test/deploy **as code** with a `Jenkinsfile`.
   * Supports **Declarative** and **Scripted** pipelines for highly customizable workflows.
3. **ğŸŒ¿ Multibranch Pipeline**

   * Automatically creates sub-jobs for each branch in your VCS repository.
   * Ideal for managing CI/CD across multiple branches.
![image](first-job.png)

## ğŸ§ª Creating and Configuring a Freestyle Jenkins Job

Creating and configuring a Jenkins Freestyle job is straightforward. Follow these steps:

### ğŸ” Step 1ï¸âƒ£: Access Jenkins

1. Log in to the Jenkins web interface.

### ğŸ†• Step 2ï¸âƒ£: Create a New Freestyle Job

1. Click **"New Item"** on the Jenkins dashboard.
2. Enter a name (e.g., **"MyFreestyleJob"**).
3. Select **"Freestyle project"** and click **"OK"**.

[Jenkins Agent Ping Tests](./Jenkins%20Agent%20Ping%20Tests.md)

[Job: first-job â€” Build Steps & Key Settings](./Job%20first-job%20â€”%20Build%20Steps%20&%20Key%20Settings.md)

[ Essential Server Setup Cheatsheet](./Essential%20Server%20Setup%20Cheatsheet.md)

[ğŸ› ï¸ Infra & Monitoring Tools Installation Guide]

### ğŸ§¾ Step 3ï¸âƒ£: Configure General Settings

1. In **"General"**:

   * ğŸ“ Add a brief description (optional).
   * ğŸ—ƒï¸ Enable **"Discard old builds"** to manage build retention.

### ğŸ”— Step 4ï¸âƒ£: Configure Source Code Management (Optional)

1. Choose the SCM system (**Git, Subversion, etc.**) and provide repository details.

### ğŸ› ï¸ Step 5ï¸âƒ£: Configure Build Steps (Continued)

Choose any steps needed for your project:

1. **ğŸ–¥ï¸ Execute Shell:** Run shell commands or scripts.
2. **ğŸªŸ Execute Windows Batch Command:** Run batch commands on Windows.
3. **ğŸœ Invoke Ant:** Run Apache Ant tasks.
4. **ğŸ§± Invoke Gradle:** Run Gradle build tasks.
5. **â˜• Invoke Maven:** Run Maven build tasks.

ğŸ’¡ For Java projects, **Invoke Maven** is commonly used to compile and build code.

### ğŸ“¦ Step 6ï¸âƒ£: Configure Post-Build Actions

After the build completes, you can:

1. **ğŸ—‚ï¸ Archive the Artifacts:** Save JARs/reports for future reference.
2. **ğŸ§ª Publish JUnit Test Result Report:** View test results within Jenkins.
3. **ğŸ” Send Build Artifacts Over SSH:** Transfer artifacts to a remote server for deployment or further processing.

### â±ï¸ Step 7ï¸âƒ£: Configure Build Triggers (Optional)

Automate when builds start:

1. **ğŸ—“ï¸ Build Periodically:** Schedule (e.g., nightly builds).
2. **ğŸ” Poll SCM:** Detect changes in the repository and trigger builds.

### ğŸ’¾ Step 8ï¸âƒ£: Save Configuration

Click **"Save"** to persist your job settings.

### â–¶ï¸ Step 9ï¸âƒ£: Run the Job

Click **"Build Now"** to start the build process.

### ğŸ“Š Step ğŸ”Ÿ: View Build Results

See console output, artifacts, and test results under **"Build History"** on the job page.

# ğŸ§ª Jenkins Pipeline Job (Declarative)

Hereâ€™s a more detailed explanation of a Jenkins pipeline job using the **Declarative Pipeline** syntax:

[Jenkins Pipelines](./Jenkins%20Pipelines.md)

[Jenkins â€” Pipeline from SCM (Git) Notes](./Jenkins%20â€”%20Pipeline%20from%20SCM%20(Git)%20Notes.md)

## ğŸ“¦ Example: Simple Maven Pipeline

This pipeline includes stages for **checking out code**, **compiling**, **testing**, and **packaging** a Maven project:

```groovy
pipeline {
    agent any
    tools {
        jdk 'jdk_name'
        maven 'maven_name'
    }
    stages {
        stage('Checkout') {
            steps {
                // Check out the source code from the repository
                git branch: 'main', url: 'https://github.com/your/repo.git'
            }
        }
        stage('Compile') {
            steps {
                // Compile the code using Maven
                sh 'mvn compile'
            }
        }
        stage('Test') {
            steps {
                // Run tests using Maven
                sh 'mvn test'
            }
        }
        stage('Package') {
            steps {
                // Package the application using Maven
                sh 'mvn package'
            }
        }
    }
    post {
        always {
            // Archive the build artifacts
            archiveArtifacts artifacts: '**/target/*.jar', allowEmptyArchive: true
        }
    }
}
```

---

## ğŸ§­ Explanation

1. **Agent** ğŸ§‘â€ğŸ’»: `agent any` tells Jenkins to run the pipeline on **any available agent**.
2. **Tools** ğŸ§°: The `tools` block specifies the required tools (JDK & Maven). Replace **`jdk_name`** and **`maven_name`** with the actual tool names configured in Jenkins.
3. **Stages** ğŸ: The `stages` block defines CI/CD steps:

   * **Checkout** ğŸ”„: Checks out the source code from the Git repository.
   * **Compile** ğŸ› ï¸: Compiles the source code using Maven.
   * **Test** âœ…: Runs tests using Maven.
   * **Package** ğŸ“¦: Packages the application (e.g., creates a JAR file).
4. **Post** ğŸ“¤: The `post` block runs actions after the pipeline finishes. Here it **archives build artifacts**, making them downloadable from Jenkins.

---

## ğŸ§™â€â™‚ï¸ Customization

* ğŸ”— Replace `https://github.com/your/repo.git` with your **actual Git repository URL**.
* ğŸ§© Ensure **Maven (`mvn`)** is installed and available on the agent running this pipeline.

This pipeline provides a clear, structured way to **automate build, test, and package** steps for your Maven project.

---

# ğŸŒ Triggering a Pipeline via Generic Webhook Trigger

## ğŸ”Œ Step 1: Install **Generic Webhook Trigger** Plugin

1. Go to **Jenkins dashboard**.
2. Navigate to **Manage Jenkins â†’ Manage Plugins**.
3. In the **Available** tab, search for **"Generic Webhook Trigger"**.
4. **Install** the plugin and **restart Jenkins** if necessary.

## âš™ï¸ Step 2: Configure Jenkins Job

1. Create or open the Jenkins job you want to trigger.
2. In the job configuration, scroll to **Build Triggers**.
3. Check **Generic Webhook Trigger** âœ….

## ğŸ“¨ Step 3: Configure **Post Parameters**

* **Variable:** `ref`
* **Expression (JSON):** `$.ref`

## ğŸ”‘ Step 4: Write a **Token**

* Provide any keyword string as a **token** to be used in the webhook URL.

## ğŸ§ª Step 5: Configure **Optional Filter**

* **Expression:** `refs/heads/branch_name` *(replace `branch_name` with your branch)*
* **Text:** `$ref`

## ğŸ™ Step 6: Configure **GitHub Webhook**

1. Go to your **GitHub repository â†’ Settings â†’ Webhooks**.
2. Click **Add webhook**.
3. **Payload URL:**

   ```
   Jenkins_URL/generic-webhook-trigger/invoke?token=github_token
   ```

   Replace `Jenkins_URL` with your Jenkins URL and `github_token` with the token you set.
   **Example:**
   `http://65.0.31.109:8080/generic-webhook-trigger/invoke?token=github_token`
4. **Content type:** `application/json`
5. **Events:** Select events to trigger the webhook (e.g., **Pushes**).

## ğŸ’¾ Step 7: Save Changes

* Save the Jenkins job configuration.
  Now your job will trigger via webhook whenever a **push event** occurs on the specified branch.

---

# ğŸŒ¿ Multibranch Pipeline: Webhook Scans

[Jenkins Multibranch Pipeline](./Jenkins%20Multibranch%20Pipeline.md)

## ğŸ”Œ Step 1: Install **Multibranch Scan Webhook Trigger** Plugin

1. **Jenkins dashboard** â†’ **Manage Jenkins â†’ Manage Plugins**.
2. In **Available**, search for **"Multibranch Scan Webhook Trigger"**.
3. **Install** and **restart** if required.

## ğŸ§­ Step 2: Configure **Multibranch Pipeline Job**

1. Create or open your **Multibranch Pipeline** job.
2. Go to **Scan Multibranch Pipeline Triggers**.
3. Select **Scan by webhook**.
4. Enter any **Trigger token** in the field.

## ğŸ™ Step 3: Configure **GitHub Webhook**

[Git Branch Management](./Webhook/Git%20Branch%20Management.md)

1. **GitHub â†’ Repository Settings â†’ Webhooks â†’ Add webhook**.
2. **Payload URL:**

```sh
Jenkins_URL/multibranch-webhook-trigger/invoke?token=token_value
```

   Replace `Jenkins_URL` with your Jenkins URL and `token_value` with the token you set.
   **Example:**
   `http://65.0.31.109:8080/multibranch-webhook-trigger/invoke?token=Devopsshack`
3. **Content type:** `application/json`
4. **Events:** Choose events (e.g., **Pushes**).

## ğŸ’¾ Step 4: Save Changes

* Save the Multibranch Pipeline job configuration.
  Now your **Multibranch Pipeline** will scan/trigger via webhook whenever a **push** occurs on your GitHub repository.
