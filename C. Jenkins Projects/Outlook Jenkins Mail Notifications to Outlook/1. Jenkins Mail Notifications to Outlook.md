# ğŸ“§ Jenkins Mail Notifications with Outlook

---

## ğŸ–¥ï¸ VM & Jenkins Setup

1. **Create Security Group (AWS SG)** ğŸ”
   Open ports in your AWS Security Group:

   * **22** â†’ SSH
   * **8080** â†’ Jenkins UI
   * **587** â†’ SMTP (Outlook)
   * **80** â†’ HTTP (optional if using webhooks)
   * **443** â†’ HTTPS (optional if securing Jenkins)

2. **Launch VM & Connect via SSH**

   ```bash
   ssh -i <your-key.pem> ubuntu@<EC2-Public-IP>
   ```

3. **Install Java & Jenkins (Official Source)**
[Install Java & Jenkins (Official Source)](https://www.jenkins.io/doc/book/installing/linux/#debianubuntu)

```sh
sudo apt install openjdk-17-jdk -y
```

1. **Start Jenkins**

   ```bash
   sudo systemctl enable jenkins
   sudo systemctl start jenkins
   ```
 

## ğŸŒ Outlook Configuration

1. Use a **personal Outlook Live account** â†’ [https://outlook.live.com](https://outlook.live.com) âœ¨
2. Enable **POP & IMAP**: âš™ï¸ â†’ **Mail â†’ Forwarding & IMAP**.
   ![image](./enable-IMAP.png)

   > **IMAP** (Internet Message Access Protocol) lets Jenkins/clients send & receive mail securely.
3. Enable **2FA (Two-Factor Authentication)** ğŸ” at [Microsoft Security](https://account.microsoft.com/security).
4. Generate an **App Password** ğŸ”‘ (used in Jenkins instead of your real Outlook password).

âš ï¸ **Note:** App passwords work only for apps (like Jenkins/SMTP), not for logging into the Outlook UI.

ğŸ“Œ **SMTP Details:**

* Server: `smtp.office365.com`
* Port: `587`
* Encryption: **TLS**

---

## ğŸ”Œ Jenkins Configuration

### Step 1: Install Plugins

ğŸ“¦ **Email Extension Plugin**
- 

ğŸ“¦ **Pipeline: Stage View**
 - The plugin gives you a visual dashboard of your pipelineâ€™s stages and their results

### Step 2: Configure Email Notifications

1. Go to **Manage Jenkins â†’ Configure System**.
2. Under **Extended E-mail Notification**, configure:

   * SMTP Server: `smtp.office365.com`
   * Port: `587`
   * âœ… click on Advance: Use SMTP Authentication
   * Username: `ofosubernard848@outlook.com`
   * Password: *App Password* ğŸ”‘ tnmdgpghqjboaudl
   * âœ… Use TLS
   * Default user e-mail suffix: `@outlook.com`
   * Reply-To: `ofosubernard848@outlook.com`

3. E-mail Notification 
   * **SMTP server:** smtp.office365.com
   * **Default user e-mail suffix:**
   * âœ… click on Advance: Use SMTP Authentication
   * Username: `ofosubernard848@outlook.com`
   * Password: *App Password* ğŸ”‘ tnmdgpghqjboaudl
   * **Clicked on Advanced**: Use **TLS**
   * Default user e-mail suffix: `@outlook.com`
   * **SMTP Port**: 
   * **Reply-To Address:** `ofosubernard848@outlook.com`
  
4. Manage Jenkins â†’ Configure System â†’ Extended E-mail Notification â†’ Advanced (expand) â†’ Allow sending to unregistered users
```sh
â˜‘ Allow sending to unregistered users
```
- â¡ï¸ If this box is not ticked, Jenkins will only send mails to addresses of Jenkins users (those registered inside Jenkins).
- â¡ï¸ If you want to send to any email (like your Outlook), make sure this box is ticked âœ….

5. Then Default Triggers
```sh
â˜‘ always
```

### Step 3: Test Email âœ…

* Scroll to **Send Test E-mail**.
* Recipient: `ofosubernard848@outlook.com`.
* Send â†’ ğŸ‰ Success = Setup complete.

Simple Pipeline
```sh
pipeline {
    agent any

    stages {
        stage('Test') {
            steps {
                echo "Sending test email..."
            }
        }
    }

    post {
        always {
            emailext(
                subject: "ğŸ“§ Jenkins Email Test",
                body: "Hello, this is a plain text test email from Jenkins!",
                to: 'ofosubernard848@outlook.com',
                from: 'ofosubernard848@outlook.com',   // added
                replyTo: 'ofosubernard848@outlook.com' // added
            )
        }
    }
}
```

## ğŸš€ Jenkins Pipeline Example

```groovy
pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                echo 'Building...'
            }
        }
        stage('Test') {
            steps {
                echo 'Testing...'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying...'
            }
        }
    }

    post {
        always {
            script {
                def jobName = env.JOB_NAME
                def buildNumber = env.BUILD_NUMBER
                def pipelineStatus = currentBuild.result ?: 'UNKNOWN'
                def bannerColor = pipelineStatus.toUpperCase() == 'SUCCESS' ? 'green' : 'red'

                def body = """
                    <html>
                    <body>
                    <div style="border: 4px solid ${bannerColor}; padding: 10px;">
                    <h2>${jobName} - Build ${buildNumber}</h2>
                    <div style="background-color: ${bannerColor}; padding: 10px;">
                    <h3 style="color: white;">Pipeline Status: ${pipelineStatus.toUpperCase()}</h3>
                    </div>
                    <p>Check the <a href="${env.BUILD_URL}">console output</a>.</p>
                    </div>
                    </body>
                    </html>
                """

                emailext (
                    subject: "${jobName} - Build ${buildNumber} - ${pipelineStatus.toUpperCase()}",
                    body: body,
                    to: 'ofosubernard848@outlook.com',
                    from: 'ofosubernard848@outlook.com',
                    replyTo: 'ofosubernard848@outlook.com',
                    mimeType: 'text/html'
                )
            }
        }
    }
}
```

---

## ğŸ“Œ Explanation

* ğŸ— **Stages** â†’ Build, Test, Deploy.
* ğŸ“¬ **Post Actions** â†’ Always send email after pipeline run.
* ğŸ¨ **Dynamic Email Body** â†’

  * Green banner âœ… = success
  * Red banner âŒ = failure
  * Includes job details + console output link.
* ğŸ“§ **Sender & Recipient** â†’ `ofosubernard848@outlook.com`.

---

## ğŸ› ï¸ Troubleshooting

1. **SMTP Authentication Error** âŒ

   * Check App Password & Port.

2. **Email Not Sent** ğŸ“­

   * Verify TLS is enabled.
   * Check Jenkins logs.
   * Confirm correct Outlook SMTP setup.

---

âœ¨ With this setup, Jenkins securely sends **pipeline notifications** to your Outlook inbox ğŸ“©.
